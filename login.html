<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Đăng Nhập • Tu Tiên Giới</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@900&family=Noto+Sans+SC:wght@500;700;900&display=swap');

    :root{
      --cyan: #7be4ff;
      --purple: #d4b3ff;
      --gold: #ffd37b;
      --red: #ff6b6b;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      height:100vh;
      background: radial-gradient(circle at 20% 30%, rgba(123,228,255,0.2), transparent 40%),
                  radial-gradient(circle at 80% 70%, rgba(255,211,123,0.15), transparent 40%),
                  #030a1a;
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      font-family:'Noto Sans SC', sans-serif;
      color:white;overflow:hidden;
      position:relative;
    }
    canvas{position:absolute;inset:0;z-index:1}

    .login-container{
      z-index:10;position:relative;text-align:center;
      padding:50px 80px;
      background:rgba(3,10,26,0.7);
      border-radius:30px;
      border:2px solid rgba(123,228,255,0.3);
      box-shadow:0 0 80px rgba(123,228,255,0.4);
      animation:float 8s ease-in-out infinite;
    }

    .logo{
      display:flex;align-items:center;justify-content:center;gap:18px;
      margin-bottom:30px;
    }
    .icon{
      width:80px;height:80px;
      background:linear-gradient(135deg,var(--cyan),var(--gold));
      border-radius:22px;
      display:flex;align-items:center;justify-content:center;
      font-size:38px;font-weight:900;color:#020b1a;
      box-shadow:0 0 50px rgba(123,228,255,0.6);
    }
    .game-name{
      font-size:48px;font-weight:900;letter-spacing:4px;
      background:linear-gradient(90deg,#fff,var(--cyan));
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }

    h1{
      font-family:'Cinzel Decorative', serif;
      font-size:72px;font-weight:900;
      letter-spacing:8px;
      background:linear-gradient(90deg,var(--cyan),var(--purple),var(--gold));
      -webkit-background-clip:text;background-clip:text;color:transparent;
      text-shadow:0 0 60px rgba(123,228,255,0.7);
      margin-bottom:40px;
    }

    .input-group{
      margin:25px 0;
      position:relative;
    }
    input{
      width:380px;padding:18px 25px;
      font-size:20px;font-weight:700;
      background:rgba(255,255,255,0.1);
      border:2px solid var(--cyan);
      border-radius:50px;
      color:white;
      outline:none;
      transition:all .4s;
    }
    input:focus{
      border-color:var(--gold);
      box-shadow:0 0 30px rgba(255,215,123,0.5);
    }
    input::placeholder{color:rgba(255,255,255,0.6)}

    .btn-login{
      margin-top:30px;
      padding:18px 90px;
      font-size:28px;font-weight:900;letter-spacing:5px;
      color:#020b1a;
      background:linear-gradient(90deg,var(--cyan),var(--gold));
      border:none;border-radius:60px;
      cursor:pointer;
      box-shadow:0 15px 50px rgba(123,228,255,0.5);
      transition:all .4s;
    }
    .btn-login:hover{
      transform:translateY(-8px) scale(1.05);
      box-shadow:0 25px 70px rgba(123,228,255,0.7);
    }

    /* Thông báo lỗi */
    .alert{
      position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
      background:rgba(255,107,107,0.95);
      color:white;padding:25px 60px;
      font-size:28px;font-weight:700;letter-spacing:3px;
      border-radius:20px;
      border:3px solid var(--red);
      box-shadow:0 0 80px rgba(255,107,107,0.7);
      z-index:9999;
      opacity:0;
      pointer-events:none;
      transition:opacity .6s;
    }
    .alert.show{opacity:1}

    @keyframes float{
      0%,100%{transform:translateY(0)}
      50%{transform:translateY(-15px)}
    }

    @media(max-width:768px){
      .login-container{padding:40px 30px}
      h1{font-size:56px}
      input{width:320px}
    }
    @media(max-width:480px){
      h1{font-size:44px;letter-spacing:4px}
      input{width:280px;font-size:18px;padding:16px 20px}
      .btn-login{font-size:24px;padding:16px 70px}
      .icon{width:60px;height:60px;font-size:30px}
      .game-name{font-size:36px}
    }
  </style>
</head>
<body>

  <canvas id="stars"></canvas>

  <div class="login-container">
    <div class="logo">
      <div class="icon">仙</div>
      <div class="game-name">Tu Tiên Giới</div>
    </div>

    <h1>Đăng Nhập</h1>

    <div class="input-group">
      <input type="text" id="username" placeholder="Đạo hiệu (tên trong game)" maxlength="12" autocomplete="off">
    </div>
    <div class="input-group">
      <input type="password" id="password" placeholder="Mật khẩu linh khí" maxlength="20">
    </div>
    <div class="input-group">
      <input type="password" id="password2" placeholder="Nhập lại mật khẩu">
    </div>

    <button class="btn-login" id="loginBtn">NHẬP MÔN</button>
  </div>

  <!-- Thông báo lỗi -->
  <div class="alert" id="alert"></div>

  <script>
    // Starfield giống hệt trang trước
    const canvas = document.getElementById('stars');
    const ctx = canvas.getContext('2d');
    let w = canvas.width = innerWidth;
    let h = canvas.height = innerHeight;
    const stars = [];

    for(let i = 0; i < 1000; i++){
      stars.push({
        x: Math.random()*w,
        y: Math.random()*h,
        r: Math.random()*1.8,
        a: Math.random()*0.8 + 0.2
      });
    }
    function draw(){
      ctx.clearRect(0,0,w,h);
      stars.forEach(s=>{
        ctx.fillStyle = `rgba(255,255,255,${s.a})`;
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
        ctx.fill();
      });
      requestAnimationFrame(draw);
    }
    draw();
    window.addEventListener('resize',()=>{w=canvas.width=innerWidth; h=canvas.height=innerHeight;});

    // Kiểm tra đăng nhập
    const savedUsers = JSON.parse(localStorage.getItem('tuTienUsers') || '{}');

    document.getElementById('loginBtn').addEventListener('click', () => {
      const username = document.getElementById('username').value.trim();
      const pass1 = document.getElementById('password').value;
      const pass2 = document.getElementById('password2').value;
      const alertBox = document.getElementById('alert');

      if (!username || !pass1 || !pass2) {
        showAlert('Vui lòng nhập đầy đủ đạo hiệu và mật khẩu!');
        return;
      }
      if (pass1 !== pass2) {
        showAlert('Hai lần nhập mật khẩu không khớp!');
        return;
      }
      if (username.length < 2 || username.length > 12) {
        showAlert('Đạo hiệu phải từ 2-12 ký tự!');
        return;
      }
      if (savedUsers[username]) {
        showAlert('Đạo hiệu đã tồn tại! Hãy chọn tên khác.');
        return;
      }

      // Đăng ký thành công
      savedUsers[username] = pass1;
      localStorage.setItem('tuTienUsers', JSON.stringify(savedUsers));
      localStorage.setItem('currentUser', username);

      alertBox.textContent = 'Đăng ký thành công! Đang khai mở linh căn...';
      alertBox.style.background = 'rgba(123,228,255,0.95)';
      alertBox.style.borderColor = '#7be4ff';
      alertBox.classList.add('show');

      setTimeout(() => {
        document.body.style.transition = 'opacity 1.5s';
        document.body.style.opacity = '0';
        setTimeout(() => {
          // Chuyển về trang game chính của bạn
          window.location.href = 'main.html'; // đổi tên file nếu cần
        }, 1600);
      }, 1500);
    });

    function showAlert(msg) {
      const alertBox = document.getElementById('alert');
      alertBox.textContent = msg;
      alertBox.classList.add('show');
      setTimeout(() => alertBox.classList.remove('show'), 3000);
    }
  </script>
</body>
</html>