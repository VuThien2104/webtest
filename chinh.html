<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Tu Ti√™n Gi·ªõi ‚Äì S·∫£nh Ch√≠nh</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#030a1a;
  font-family:system-ui,sans-serif;
  color:white;
  height:100vh;
}
.main-hall{
  height:100%;
  display:grid;
  grid-template-rows:140px 1fr 120px;
  padding:20px;
  gap:16px;
}
.header{
  display:flex;
  align-items:center;
  gap:20px;
  background:rgba(3,10,26,.7);
  border:2px solid #7be4ff;
  border-radius:24px;
  padding:20px;
}
.avatar{
  width:96px;height:96px;
  border-radius:50%;
  border:4px solid #7be4ff;
  object-fit:cover;
}
.player-info{
  flex:1;
  text-align:center;
}
.player-name{
  font-size:36px;
  font-weight:900;
}
.player-realm{
  font-size:22px;
  opacity:.85;
}
.setting-btn{
  width:64px;height:64px;
  border-radius:50%;
  background:#7be4ff;
  color:#000;
  font-size:32px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.menu-grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:20px;
  max-width:1100px;
  margin:0 auto;
}
.menu-btn{
  aspect-ratio:1;
  background:rgba(3,10,26,.75);
  border:3px solid #7be4ff;
  border-radius:28px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-size:42px;
  cursor:pointer;
  transition:.35s;
  box-shadow:0 0 40px rgba(123,228,255,.3);
}
.menu-btn span{
  margin-top:12px;
  font-size:20px;
  font-weight:800;
  letter-spacing:2px;
}
.menu-btn:hover{
  transform:translateY(-12px) scale(1.05);
  border-color:#ffd37b;
  box-shadow:0 20px 70px rgba(255,211,123,.6);
}

.footer{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 32px;
  background:rgba(3,10,26,.7);
  border:2px solid rgba(123,228,255,.4);
  border-radius:24px;
}
.quick-btn{
  width:72px;height:72px;
  border-radius:50%;
  background:#7be4ff;
  color:#000;
  font-size:34px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.task-bar{
  flex:1;
  margin:0 20px;
  text-align:center;
  font-size:18px;
  opacity:.9;
}

</style>
</head>

<body>

<div class="main-hall">

  <!-- HEADER -->
  <div class="header">
    <img id="avatar" class="avatar">
    <div class="player-info">
      <div id="playerName" class="player-name"></div>
      <div id="playerRealm" class="player-realm"></div>
    </div>
    <div class="setting-btn" onclick="openSetting()">‚öô</div>
  </div>

 <!-- MENU -->
<div class="menu-grid">
  <div class="menu-btn" onclick="goTo('congphap')">üìò<span>C√îNG PH√ÅP</span></div>
  <div class="menu-btn" onclick="goTo('dotpha')">‚ö°<span>ƒê·ªòT PH√Å</span></div>
  <div class="menu-btn" onclick="goTo('phoban')">üèØ<span>PH√ì B·∫¢N</span></div>
  <div class="menu-btn" onclick="goTo('thuongdiem')">üíé<span>TH∆Ø∆†NG ƒêI·∫æM</span></div>
  <div class="menu-btn" onclick="goTo('bangxephang')">üèÜ<span>X·∫æP H·∫†NG</span></div>
  <div class="menu-btn" onclick="goTo('tongmon')">üõï<span>T√îNG M√îN</span></div>
</div>

<!-- FOOTER -->
<div class="footer">
  <div class="quick-btn" onclick="openBag()">üéí</div>
  <div class="task-bar" id="taskText">
    Nhi·ªám v·ª• ch√≠nh: Ch∆∞a c√≥
  </div>
  <div class="quick-btn">üí¨</div>
</div>

  <div></div>

</div>

<script>
/* =========================
   PLAYER STORE (REACT ‚Üí JS)
========================= */
const playerState = {
  name: localStorage.getItem('player.name') || 'V√¥ Danh Ti√™n',
  realm: localStorage.getItem('player.realm') || 'Luy·ªán Kh√≠ t·∫ßng 1',
  spirit: Number(localStorage.getItem('player.spirit') || 100),
  avatar: localStorage.getItem('player.avatar')
};

/* =========================
   RENDER PLAYER (JSX ‚Üí DOM)
========================= */
function renderPlayer(){
  document.getElementById('playerName').textContent = playerState.name;
  document.getElementById('playerRealm').textContent =
    `${playerState.realm} ‚Ä¢ Linh l·ª±c ${playerState.spirit}`;
  document.getElementById('avatar').src =
    playerState.avatar || 'https://i.ibb.co.com/9bY8YhL/default-avatar.png';
}
renderPlayer();

/* =========================
   UI STATE
========================= */
function openSetting(){
  alert('Setting panel s·∫Ω vi·∫øt ·ªü ph·∫ßn sau');
}
/* =========================
   MENU ROUTER (REACT ROUTER ‚Üí JS)
========================= */
function goTo(page){
  document.body.style.transition = 'opacity .8s';
  document.body.style.opacity = '0';
  setTimeout(()=>{
    location.href = `./${page}.html`;
  },800);
}

/* =========================
   TASK STATE (GI·ªêNG REACT)
========================= */
const taskState = {
  text: localStorage.getItem('task.main') ||
        'Thu th·∫≠p 10 g·ªëc Linh Th·∫£o (0/10)'
};

document.getElementById('taskText').textContent =
  `Nhi·ªám v·ª• ch√≠nh: ${taskState.text}`;

/* =========================
   BAG PLACEHOLDER (VI·∫æT PH·∫¶N 3)
========================= */
function openBag(){
  alert('T√∫i ƒë·ªì s·∫Ω ƒë∆∞·ª£c vi·∫øt ·ªü ph·∫ßn ti·∫øp theo');
}

</script>
<!-- =========================
     PH·∫¶N 3 ‚Äì SETTING PANEL + T√öI ƒê·ªí + UI STATE
     D√ÅN TI·∫æP V√ÄO CU·ªêI FILE (SAU PH·∫¶N 2)
========================= -->

<!-- SETTING OVERLAY -->
<div id="settingOverlay" class="overlay">
  <div class="panel">
    <h2>C√ÄI ƒê·∫∂T</h2>

    <div class="panel-item">
      <label>ƒê·∫°o hi·ªáu</label>
      <input id="nameInput" type="text" placeholder="Nh·∫≠p ƒë·∫°o hi·ªáu">
      <button onclick="saveName()">L∆∞u</button>
    </div>

    <div class="panel-item">
      <label>ƒê·ªïi avatar</label>
      <input type="file" accept="image/*" onchange="changeAvatar(event)">
    </div>

    <div class="panel-item">
      <button onclick="toggleSound()" id="soundBtn">√Çm thanh: ON</button>
    </div>

    <button class="danger" onclick="logout()">ƒêƒÉng xu·∫•t</button>
  </div>
</div>

<!-- BAG OVERLAY -->
<div id="bagOverlay" class="overlay">
  <div class="panel">
    <h2>T√öI ƒê·ªí</h2>
    <ul id="bagList"></ul>
    <button onclick="closeBag()">ƒê√≥ng</button>
  </div>
</div>

<style>
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.panel{
  width:420px;
  max-width:90%;
  background:#020617;
  border:3px solid #7be4ff;
  border-radius:28px;
  padding:28px;
  text-align:center;
}
.panel h2{
  margin-bottom:20px;
}
.panel-item{
  margin:16px 0;
}
.panel input{
  width:100%;
  padding:10px;
  border-radius:12px;
  border:1px solid #7be4ff;
  background:#000;
  color:#fff;
}
.panel button{
  margin-top:10px;
  padding:10px 18px;
  border:none;
  border-radius:14px;
  background:#7be4ff;
  cursor:pointer;
}
.panel button.danger{
  background:#ff6b6b;
  color:#fff;
}
#bagList{
  list-style:none;
  padding:0;
}
#bagList li{
  padding:8px 0;
  border-bottom:1px solid rgba(255,255,255,.1);
}
</style>

<script>
/* =========================
   UI STATE
========================= */
const uiState = {
  setting:false,
  bag:false
};

function openSetting(){
  uiState.setting=true;
  document.getElementById('settingOverlay').style.display='flex';
}
function closeSetting(){
  uiState.setting=false;
  document.getElementById('settingOverlay').style.display='none';
}
function openBag(){
  uiState.bag=true;
  document.getElementById('bagOverlay').style.display='flex';
  renderBag();
}
function closeBag(){
  uiState.bag=false;
  document.getElementById('bagOverlay').style.display='none';
}

window.addEventListener('click',e=>{
  if(e.target.id==='settingOverlay') closeSetting();
  if(e.target.id==='bagOverlay') closeBag();
});
window.addEventListener('keydown',e=>{
  if(e.key==='Escape'){
    closeSetting();
    closeBag();
  }
});

/* =========================
   PLAYER UPDATE
========================= */
function saveName(){
  const val=document.getElementById('nameInput').value.trim();
  if(!val) return;
  playerState.name=val;
  localStorage.setItem('player.name',val);
  renderPlayer();
}

/* =========================
   SOUND STATE
========================= */
let soundOn = localStorage.getItem('soundOn')!=='false';
function toggleSound(){
  soundOn=!soundOn;
  localStorage.setItem('soundOn',soundOn);
  document.getElementById('soundBtn').textContent =
    soundOn?'√Çm thanh: ON':'√Çm thanh: OFF';
}

/* =========================
   BAG STATE
========================= */
const bagState = JSON.parse(localStorage.getItem('bag.items')||'[]');
if(bagState.length===0){
  bagState.push('üíä ƒêan D∆∞·ª£c x3','üó°Ô∏è Phi Ki·∫øm','üìò C√¥ng Ph√°p s∆° c·∫•p');
  localStorage.setItem('bag.items',JSON.stringify(bagState));
}
function renderBag(){
  const ul=document.getElementById('bagList');
  ul.innerHTML='';
  bagState.forEach(i=>{
    const li=document.createElement('li');
    li.textContent=i;
    ul.appendChild(li);
  });
}

/* =========================
   LOGOUT
========================= */
function logout(){
  localStorage.clear();
  location.href='index.html';
}
</script>
<!-- =========================
     PH·∫¶N 4 ‚Äì HI·ªÜU ·ª®NG, TRANSITION, KH·ªûI T·∫†O GI·ªêNG REACT
     D√ÅN TI·∫æP V√ÄO CU·ªêI FILE
========================= -->

<style>
/* FADE IN / OUT */
body{
  opacity:0;
  transition:opacity .8s ease;
}
body.ready{opacity:1}

/* FLOAT EFFECT */
@keyframes float{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-12px)}
}
.avatar,.setting-btn,.quick-btn{
  animation:float 6s ease-in-out infinite;
}

/* CLICK RIPPLE */
.menu-btn::after{
  content:'';
  position:absolute;
  width:0;height:0;
  border-radius:50%;
  background:rgba(255,255,255,.3);
  transform:translate(-50%,-50%);
  opacity:0;
}
.menu-btn:active::after{
  width:200%;
  height:200%;
  opacity:1;
  transition:0s;
}
</style>

<script>
/* =========================
   INIT (GI·ªêNG useEffect)
========================= */
window.addEventListener('load',()=>{
  document.body.classList.add('ready');
  syncSound();
});

/* =========================
   SAVE STATE TR∆Ø·ªöC KHI R·ªúI
========================= */
window.addEventListener('beforeunload',()=>{
  localStorage.setItem('player.name',playerState.name);
  localStorage.setItem('player.realm',playerState.realm);
  localStorage.setItem('player.spirit',playerState.spirit);
});

/* =========================
   FAKE REALM PROGRESS (DEMO)
========================= */
function gainSpirit(val){
  playerState.spirit+=val;
  if(playerState.spirit>=1000){
    playerState.spirit=0;
    playerState.realm='Luy·ªán Kh√≠ t·∫ßng 2';
  }
  renderPlayer();
}

/* =========================
   CHAT PLACEHOLDER
========================= */
document.querySelectorAll('.quick-btn')[1].onclick=()=>{
  alert('H·ªá th·ªëng chat s·∫Ω ƒë∆∞·ª£c m·ªü ·ªü b·∫£n sau');
};

/* =========================
   DEBUG (T·∫ÆT SAU)
========================= */
window.__player=playerState;
window.__ui=uiState;
</script>
<!-- =========================
     PH·∫¶N 5 ‚Äì HO√ÄN THI·ªÜN S·∫¢NH (FINAL)
========================= -->

<style>
/* KH√ìA SELECT + DRAG (GI·ªêNG BUILD) */
body{
  user-select:none;
  -webkit-user-drag:none;
}
img{pointer-events:none}

/* LOADING OVERLAY */
#loading{
  position:fixed;
  inset:0;
  background:#020617;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:2000;
  font-size:28px;
  letter-spacing:4px;
}
#loading.hide{
  opacity:0;
  pointer-events:none;
  transition:opacity .8s;
}
</style>

<div id="loading">ƒêANG K·∫æT N·ªêI TI√äN GI·ªöI...</div>

<script>
/* =========================
   LOADING FAKE (GI·ªêNG APP)
========================= */
window.addEventListener('load',()=>{
  setTimeout(()=>{
    document.getElementById('loading').classList.add('hide');
  },800);
});

/* =========================
   GUARD ‚Äì CH∆ØA LOGIN ‚Üí V·ªÄ LOGIN
========================= */
if(!localStorage.getItem('player.name')){
  location.href='index.html';
}

/* =========================
   MENU LOCK (ANTI DOUBLE CLICK)
========================= */
let routing=false;
function goTo(page){
  if(routing) return;
  routing=true;
  document.body.style.opacity='0';
  setTimeout(()=>{
    location.href=`./${page}.html`;
  },700);
}

/* =========================
   CLEAN CONSOLE (OPTIONAL)
========================= */
console.clear();
console.log('%cTU TI√äN GI·ªöI','color:#7be4ff;font-size:24px;font-weight:900');

/* =========================
   FREEZE STATE STRUCTURE
========================= */
Object.freeze(playerState);
Object.freeze(uiState);

/* =========================
   END
========================= */
</script>

</body>
</html>
